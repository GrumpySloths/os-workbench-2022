# 待办事项

- [x] 尝试重新看一下蒋老师的速通，在中断和并发完全关闭的情况下看能不能解决当前的bug。
- [ ] 实现slab形式的 malloc和free
- [ ] 当前程序在没有fork存在的情况下只是简单的不断循环打印会突然出现疑似context损坏的情况，
但注释掉sane_context(context)检测代码后程序可以正常运行，且这种疑似损坏的状况总是出现在多次syscall后的
timer中断下返回的context，怀疑它可能是之前一直没有注意到的罕见的slow path导致程序误报
- [ ] 想要添加简单的对malloc的double-allocation assert检验，但每次更改magic的值都会导致page_fault插入的新添加的页都有很奇怪的变化，初步怀疑是页表系统被意外覆写和修改了
- [x] 当前的task->stack无法赋值


## 注意事项

1. 要注意进程运行的堆栈和内核栈是两个完全不同的东西,要分别进行相应的内存分配
2. 这次的错误实际上又是一个基础概念没有理解清楚的错误，没有意识到current_task中的context并不是实时进行更新的，而是每次经过一个timer或yield之后才会同步，但每次陷入内核的context才是对之前状态的最新版封存状态
3. 对于经过一个函数作用后状态机会发生很大变化的情况一定要进行检测看状态机是否符合预期